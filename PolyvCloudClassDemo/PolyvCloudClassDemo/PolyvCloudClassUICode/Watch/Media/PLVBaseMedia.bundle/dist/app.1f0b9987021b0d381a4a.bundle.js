!function(c){function e(e){for(var t,n,i=e[0],s=e[1],r=e[2],a=0,o=[];a<i.length;a++)n=i[a],u[n]&&o.push(u[n][0]),u[n]=0;for(t in s)Object.prototype.hasOwnProperty.call(s,t)&&(c[t]=s[t]);for(p&&p(e);o.length;)o.shift()();return d.push.apply(d,r||[]),l()}function l(){for(var e,t=0;t<d.length;t++){for(var n=d[t],i=!0,s=1;s<n.length;s++){var r=n[s];0!==u[r]&&(i=!1)}i&&(d.splice(t--,1),e=a(a.s=n[0]))}return e}var n={},u={0:0},d=[];function a(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return c[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=c,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/assets/websdk/";var t=window.webpackJsonp=window.webpackJsonp||[],i=t.push.bind(t);t.push=e,t=t.slice();for(var s=0;s<t.length;s++)e(t[s]);var p=i;d.push([170,1]),l()}({109:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},155:function(e,t,n){},166:function(e,t,n){},167:function(e,t,n){},168:function(e,t,n){},169:function(e,t,n){},170:function(e,t,n){"use strict";n.r(t);var i=n(10),d=n.n(i),s=n(11),p=n.n(s),r=n(23),l=n.n(r),a=n(2),o=n.n(a),c=n(1),u=n.n(c),v=(n(109),n(30)),h=n.n(v),w=n(5),f=n.n(w),m=n(6),b=n.n(m),g=n(7),y=n.n(g),k=n(8),S=n.n(k);function L(e){var t=window.location.search,n=new RegExp("(^|&)".concat(e,"=([^&]*)(&|$)")),i=t.substr(1).match(n);return i?decodeURIComponent(i[2].replace(/\s*/g,"")):null}window.chooseAnswer=function(e){},window.endQuestionnaireAnswer=function(e){},window.sendWinData=function(e){},window.abandonLottery=function(){},window.submitSign=function(){},window.closeWebview=function(){},window.initWebview=function(){},window.linkClick=function(e){},window.sendWKWebViewMessage=function(e,t){window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers[e]&&window.webkit.messageHandlers[e].postMessage(t)},L("version");var E,T=new(function(e){function t(){return o()(this,t),f()(this,b()(t).call(this))}return y()(t,e),u()(t,[{key:"chooseAnswer",value:function(e){console.log(e),window.chooseAnswer(e),window.sendWKWebViewMessage("chooseAnswer",e);try{window.WebViewJavascriptBridge.callHandler("chooseAnswer",e)}catch(e){}}},{key:"endQuestionnaireAnswer",value:function(e){window.endQuestionnaireAnswer(e),window.sendWKWebViewMessage("endQuestionnaireAnswer",e);try{window.WebViewJavascriptBridge.callHandler("endQuestionnaireAnswer",e)}catch(e){}}},{key:"sendWinData",value:function(e){window.sendWinData(e),window.sendWKWebViewMessage("sendWinData",e);try{window.WebViewJavascriptBridge.callHandler("sendWinData",e)}catch(e){}}},{key:"abandonLottery",value:function(){window.abandonLottery(),window.sendWKWebViewMessage("abandonLottery","");try{window.WebViewJavascriptBridge.callHandler("abandonLottery")}catch(e){}}},{key:"submitSign",value:function(){window.submitSign(),window.sendWKWebViewMessage("submitSign","");try{window.WebViewJavascriptBridge.callHandler("submitSign")}catch(e){}}},{key:"closeWebview",value:function(){window.closeWebview(),window.sendWKWebViewMessage("closeWebview","");try{window.WebViewJavascriptBridge.callHandler("closeWebview")}catch(e){}}},{key:"initWebview",value:function(){window.initWebview(),window.sendWKWebViewMessage("initWebview","");try{window.WebViewJavascriptBridge.callHandler("initWebview")}catch(e){}}},{key:"linkClick",value:function(e){window.linkClick(e),window.sendWKWebViewMessage("linkClick",e);try{window.WebViewJavascriptBridge.callHandler("linkClick",e)}catch(e){}}}]),t}(S.a));window.updateNewQuestion=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("updateNewQuestion",e),t("收到答题信息")},window.hasChooseAnswer=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("hasChooseAnswer",e),t("收到答题结果:"+e)},window.testQuestion=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("extraQuestionMessageHandler",e),t("收到额外消息:"+e)},window.startQuestionNaire=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("startQuestionNaire",e),t("收到问卷信息:"+e)},window.stopQuestionNaire=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("stopQuestionNaire",e),t("收到问卷结束:"+e)},window.startLottery=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("startLottery",e),t("收到抽奖开始:"+e)},window.stopLottery=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("stopLottery",e),t("收到抽奖结束:"+e)},window.startSign=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("startSign",e),t("收到签到开始"+e)},window.stopSign=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("stopSign",e),t("收到签到结束"+e)},window.closeLotteryWinner=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("closeLotteryWinner",e),t("收到中奖中关闭窗口"+e)},window.bulletin=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("bulletin",e),t("收到公告"+e)},window.removeBulletin=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("removeBulletin",e),t("收到删除公告"+e)},window.onStartRecord=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("onStartRecord",e),t("收到开始直播"+e)},window.onPauseRecord=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("onPauseRecord",e),t("收到暂停直播"+e)},window.onExitRecord=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("onExitRecord",e),t("收到下课事件"+e)},window.interactiveEventCallback=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};T.emit("interactiveEventCallback",e),t("收到互动提交callback事件"+e)},E=function(e){e.init(function(e,t){}),T.emit("bridgeInit"),e.registerHandler("updateNewQuestion",window.updateNewQuestion),e.registerHandler("hasChooseAnswer",window.hasChooseAnswer),e.registerHandler("testQuestion",window.testQuestion),e.registerHandler("startQuestionNaire",window.startQuestionNaire),e.registerHandler("stopQuestionNaire",window.stopQuestionNaire),e.registerHandler("startLottery",window.startLottery),e.registerHandler("stopLottery",window.stopLottery),e.registerHandler("startSign",window.startSign),e.registerHandler("stopSign",window.stopSign),e.registerHandler("closeLotteryWinner",window.closeLotteryWinner),e.registerHandler("bulletin",window.bulletin),e.registerHandler("removeBulletin",window.removeBulletin),e.registerHandler("onStartRecord",window.onStartRecord),e.registerHandler("onPauseRecord",window.onPauseRecord),e.registerHandler("onExitRecord",window.onExitRecord),e.registerHandler("interactiveEventCallback",window.interactiveEventCallback)},window.WebViewJavascriptBridge?E(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){E(WebViewJavascriptBridge)},!1);var C=T,W=n(14),q=n.n(W),I=n(58),x=n.n(I),A=(n(147),L("version")),O="ABCDEFGHIJKLMNOPQRSTUVWXYZ",H={parseString:function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").trim()},questionTypeTxt:function(e){return"S"===e?"评分":"C"===e?"多选":"单选"},isMultiSelect:function(e){return"C"===e},getStatusClass:function(e){var t="";switch(e){case"success":t="answer-right";break;case"error":t="answer-error";break;case"checked":t="answer-checked";break;case"selectRight":t="answer-right-select";break;case"normal":t="answer-normal";break;case"noselect":t="no-select";break;case"scoreResult":t="score-result"}return t},option:function(e){var t=e.ratio,n=void 0===t?"0":t,i=e.contain,s=void 0===i?"":i,r=e.type,a=void 0===r?"":r,o=e.index,c=e.count,l=void 0===c?"":c,u=e.tips,d=void 0===u?"":u;if(!s)return"";var p=this.parseString(s);return'\n    <li class="'.concat(this.getStatusClass(a),'" data-options="').concat(o,'">\n      <div class="ppt-answer-ratio" style="width:').concat(n,'"></div>\n      <div class="ppt-answer-option').concat(d&&" ppt-answer-option-hastips",'"><span>').concat(o,". </span>").concat(p,'</div>\n      <span class="ppt-answer-count">').concat(l,"</span>\n      ").concat(d&&'<div class="ppt-answer-option-tips">'.concat(p+"："+d,"</div>"),"\n    </li>\n    ")},getOptions:function(t){for(var e=d()(t).filter(function(e){return-1!==e.indexOf("option")&&t[e]}).length,n="",i=0;i<e;i++)n+=this.option({contain:(t["option".concat(i+1)]||"").toString(),index:O[i],type:t["type".concat(i+1)],ratio:t["ratio".concat(i+1)]||0,count:t["result".concat(i+1)],tips:"S"===t.type?t["tips".concat(i+1)]:void 0});return n},card:function(e){var t="id-".concat((new Date).getTime()),n=document.createElement("div");return n.setAttribute("class","ppt-answer-card ".concat(e.tipsClass||"").concat(1===e.itemType?" ppt-answer-card-fast":"").concat("S"===e.type?" ppt-answer-card-score":"")),n.innerHTML='<div class="ppt-answer-head">\n      '.concat(e.tips,'\n      <span class="ppt-answer-close" data-type="close">×</span>\n    </div>\n    ').concat(e.total?'<div class="ppt-answer-contain">\n        <h3><span>【'.concat(this.questionTypeTxt(e.type),"】</span>").concat(this.parseString(e.title||e.name),'</h3>\n        <div class="ppt-answer-contain-result">\n          <div class="ppt-answer-score-title">平均得分</div>\n          <div  class="ppt-answer-score-result"><span class="ppt-answer-score-integer">').concat(e.total[0],'</span><span class="ppt-answer-score-decimal">.').concat(e.total[1],"</span></div>\n        </div>\n      </div>\n      "):'<div class="ppt-answer-contain">\n        <h3><span>【'.concat(this.questionTypeTxt(e.type),"】</span>").concat(this.parseString(e.title||e.name),'</h3>\n        <ul class="ppt-answer-list">\n          ').concat(this.getOptions(e),'\n        </ul>\n      </div>\n      <div class="ppt-answer-foot">\n        <span id="').concat(t,'" class="ppt-answer-btn ').concat(e.btnClass||"",'" data-type="').concat(e.submitType,'">').concat(e.btn,"</span>\n      </div>"),"\n    "),{el:n,id:t}},tips:function(e){var t=document.createElement("div");return t.textContent=e,t.classList.add("ppt-answer-tips"),t}},N=function(e){function n(e){var t;return o()(this,n),(t=f()(this,b()(n).call(this))).wrap=document.getElementById(e),t.el=null,t.btn=null,t.visible=!1,t.selectOptions=[],t.currentStatus={},t}return y()(n,e),u()(n,[{key:"updateNewQuestion",value:function(e){this.visible=!0,this.currentStatus={id:e.questionId,type:"commit"},this.selectOptions=[];var t=x()({submitType:"commit",btn:"提交",tips:"S"===e.type?"评分":"答题卡"},e);this.initElement(t,!0,e.questionId,H.isMultiSelect(t.type))}},{key:"getTotalResult",value:function(e){var t=[];return-1!==(e+="").indexOf(".")?t=e.split("."):(t.push(e),t.push("0000")),t}},{key:"getTotalScore",value:function(t,n){var i=[];d()(t).filter(function(e){return-1!==e.indexOf("option")}).forEach(function(e){return i.push(t[e])});var s=0;return i.map(function(e,t){return e&&e*n[t]}).forEach(function(e){return s+=e}),s}},{key:"hasChooseAnswer",value:function(e,t){this.visible=!0,this.currentStatus={id:t.questionId,type:"close"};var n=null;if("S"===t.content.type){var i=this.getTotalScore(t.content,t.result.singleResult),s=0===t.result.total?0:(i/t.result.total).toFixed(4);n=this.getTotalResult(s)}t.result=t.data||t.result;var r=this.createResultData(e,t.result),a=this.getResultTips(e,t.result.answer,t.questionId,n),o=x()({submitType:"close",btn:"知道了",btnClass:"answer-primary",tips:a.tips,tipsClass:a.tipsClass,total:n},r,t,t.content);this.initElement(o,!1)}},{key:"stopQuestion",value:function(e){if(this.el&&"commit"===this.currentStatus.type&&this.currentStatus.id===e.questionId){this.currentStatus.type="stop";var t=H.getStatusClass("checked");this.btn.classList.remove("answer-primary"),this.btn.textContent="已截止",this.selectOptions=[],q()(this.el.querySelectorAll(".".concat(t))).forEach(function(e){e.classList.remove(t)})}else this.emit("knowAnswer")}},{key:"initElement",value:function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];this.removeCard();var s=H.card(e);this.el=s.el,this.wrap.appendChild(this.el),this.btn=document.getElementById(s.id),this.wrap.classList.add("answer-show"),this.bindEvent(t,n,i)}},{key:"getResultTips",value:function(e,t,n,i){var s=e||"",r="",a="";return i?a=H.getStatusClass("scoreResult"):s?a=s===t?(r="回答正确",H.getStatusClass("success")):(r="回答错误",H.getStatusClass("error")):r="未作答",{tips:r,tipsClass:a}}},{key:"createResultData",value:function(e,i){var s=this,r={},a=e.split("");return i.singleResult.forEach(function(e,t){var n=O[t];r["result".concat(t+1)]=e,r["ratio".concat(t+1)]=e/(i.total||1)*100+"%",r["type".concat(t+1)]=s.getAnswerType(i.answer,n,-1!==a.indexOf(n),e)}),r}},{key:"getAnswerType",value:function(e,t,n,i){var s=-1!==e.indexOf(t);return s&&n?"selectRight":!i&&s?"noselect":s?"success":!s&&n?"error":"normal"}},{key:"bindEvent",value:function(e,n){var s=this,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],a=null;this.el.addEventListener("click",function(e){var t=e.target.getAttribute("data-type");t&&("close"===t&&(s.removeCard(),s.emit("knowAnswer")),"commit"===t&&s.commit(n))}),e&&this.el.addEventListener("click",function(e){if("stop"!==s.currentStatus.type){for(var t=!0,n=e.target,i=null;t;){if(i=n.getAttribute("data-options")){t=!1;break}if(n===s.el){t=!1,n=null;break}if(!(n=n.parentNode))break}i&&(r?s.multiHandler(n,i):a=s.singleHandler(a,n,i))}})}},{key:"multiHandler",value:function(e,t){var n=H.getStatusClass("checked"),i=this.selectOptions.indexOf(t);-1<i?this.selectOptions.splice(i,1):this.selectOptions.push(t),0<this.selectOptions.length?this.btn.classList.add("answer-primary"):this.btn.classList.remove("answer-primary"),e.classList.toggle(n)}},{key:"singleHandler",value:function(e,t,n){var i=H.getStatusClass("checked");return e&&e.classList.remove(i),t.classList.add(i),this.selectOptions=[n],this.btn.classList.add("answer-primary"),t}},{key:"sortResult",value:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).sort().join("")}},{key:"commit",value:function(e){var t=this,n=this.sortResult(this.selectOptions);if(n){if(this.removeCard(),6<=A)return this.emit("chooseAnswer",{answerId:n,questionId:e}),this.visible=!1,void this.emit("knowAnswer");this.showTips("提交成功",1.5,function(){t.emit("chooseAnswer",{answerId:n,questionId:e}),t.emit("knowAnswer")})}}},{key:"removeCard",value:function(){this.el&&(this.wrap.removeChild(this.el),this.el=null,this.wrap.classList.remove("answer-show"))}},{key:"showTips",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},s=H.tips(e);this.wrap.appendChild(s),this.wrap.classList.add("answer-show"),n&&setTimeout(function(){t.wrap.removeChild(s),t.wrap.classList.remove("answer-show"),i()},1e3*n)}}]),n}(S.a),Q=n(57),P=n.n(Q),R=(n(148),n(37)),V=n.n(R),M=n(39),B=n.n(M),J={mainTmp:function(e){var t=this.getScore(e),n=t.totalScore,i=t.averageScore,s=document.createElement("div");return s.setAttribute("class","plv-questionnaire-result-container"),s.innerHTML='\n      <div class="qn-result-head">\n        <h4>'.concat(e.questionnaireTitle,'</h4>\n        <ul class="qn-head-right">\n          <li>\n            <p>提交量</p>\n            <span>').concat(e.total,"</span>\n          </li>\n          <li>\n            <p>总分</p>\n            <span>").concat(n,"</span>\n          </li>\n          <li>\n            <p>平均分</p>\n            <span>").concat(i,'</span>\n          </li>\n        </ul>\n      </div>\n      <div class="qn-result-body">\n        ').concat(this.getMainContent(e.data),'\n      </div>\n      <div class="qn-result-footer">\n        <button id="questionnaireResultClose">关闭</button>\n      </div>\n    ').trim(),s},qnContent:function(e){if("Q"===e.type)return'<div class="qn-body-list">非选择题结果不显示</div>';var t="",n="";switch(e.type){case"R":t="<p>单选</p>";break;case"C":t="<p>多选</p>";break;default:t="<p>问答</p>"}"Y"===e.scoreEnabled&&(n="\n        <span>".concat(Number(e.score),'分题</span>\n        <span class="result-average">平均分：').concat(B()(e.totalScore/e.total).toFixed(),"</span>\n      "));var i="Y"===e.required?'<span class="result-require">*</span>':"";return'\n      <div class="qn-body-list">\n        <div class="qn-body-title">\n          '.concat(t).concat(n,'\n        </div>\n        <h4 class="qn-body-name">').concat(e.name).concat(i,"</h4>\n        <ul>\n          ").concat(this.returnOptions(e),"\n        </ul>\n      </div>")},options:function(e){var t=e.rightAnswer,n=t?'<span class="right-option-gou"></span>':"",i=t?"right-color":"normal-color";return'\n      <li class="result-options-wrap">\n        <div class="result-percent-head '.concat(t?"right-hover-color":"normal-hover-color",'" style="width: ').concat(V()(e.percent),'%"></div>\n        <div class="result-full"></div>\n        <div class="result-percent-total">\n          ').concat(n,'\n          <span class="result-options-list">').concat("ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(e.index),". ").concat(e.option,'</span>\n          <span class="result-options-percent ').concat(i,'">').concat(e.count,"票 (").concat(e.percent,"%}</span>\n        </div>\n      </li>\n    ")},returnOptions:function(e){var n=this;return this.getOptionsDetail(e).reduce(function(e,t){return"".concat(e).concat(n.options(t))},"")},getMainContent:function(e){var n=this;return e.reduce(function(e,t){return"".concat(e).concat(n.qnContent(t)).trim()},"")},getSingleOptionPercent:function(e,t){return 0===Number(t)?0:B()(100*e/t).toFixed(2)},returnIsAnswer:function(e,t){return-1!==e.split("").map(function(e){return e.toUpperCase().charCodeAt()-65}).join("").indexOf(t)},getOptionsDetail:function(n){var i=this,s=[],r=n.answerResult;return d()(n).filter(function(e){return 0===e.indexOf("option")&&n[e]}).forEach(function(e,t){s.push({option:n[e],percent:i.getSingleOptionPercent(r[t],n.total),rightAnswer:i.returnIsAnswer(n.answer,t),index:t,count:r[t]})}),s},getScore:function(e){var t=0,n=0;e.data.forEach(function(e){"Q"!==e.type&&(t+=Number(e.score),n+=Number(e.totalScore))});var i=B()(n/e.total).toFixed(2);return{totalScore:t,averageScore:i}}},D="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function K(e){var t=window.location.search,n=new RegExp("(^|&)".concat(e,"=([^&]*)(&|$)")),i=t.substr(1).match(n);return i?decodeURIComponent(i[2].replace(/\s*/g,"")):null}var _=K("version"),U=K("useWKWebviewForIOS"),Z={parseString:function(e){return e&&"number"!=typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;").trim():e},layout:function(e,t){e.questions;var n=e.title,i=void 0===n?"":n,s=t?"live-questionnaire-pc":"live-questionnaire-mobile",r=t?"":'<div class="live-questionnaire-head">\n    '.concat(this.parseString(i),'\n    <span data-type="close">×</span>\n    </div>'),a=document.createElement("div");return a.setAttribute("class","live-questionnaire ".concat(s)),a.innerHTML="\n    ".concat(r,'\n    <div class="live-questionnaire-container">\n      <div class="live-questionnaire-content js-questionnaireContent">\n\n      </div>\n    </div>').trim(),a},option:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length?arguments[2]:void 0;return t=this.parseString(t),'\n    <div class="live-questionnaire-option live-questionnaire-option-'.concat(e,'" title="').concat(t,'" data-answer="').concat(D[n],'">\n      <span>').concat(D[n],".").concat(t,"</span>\n    </div>\n    ").trim()},textarea:function(){return"\n      <textarea></textarea>\n    ".trim()},btn:function(){var e=document.createElement("div");return e.setAttribute("class","live-questionnaire-foot"),e.innerHTML='<span data-type="submit">提交</span>',e},question:function(n){var e,i=this;if("Q"===n.type)e=this.textarea();else{var s=[];n.options.forEach(function(e,t){t%2==0?s.push([e]):s[s.length-1].push(e)});var r=0;e=s.reduce(function(e,t){return"".concat(e,'<div class="live-questionnaire-question-col">').concat(i.option(n.type,t[0],r++)).concat(t[1]?i.option(n.type,t[1],r++):"","</div>")},"")}var t=document.createElement("div");return t.setAttribute("class","live-questionnaire-question"),t.innerHTML='<div class="live-questionnaire-question-head">'.concat(n.index,"、").concat(this.parseString(n.name),"<sup>").concat(n.required?"*":"","</sup>").concat("C"===n.type?" <span>(多选)</span>":"",'</div>\n      <div class="live-questionnaire-question-error ppt-hide js-questionnaireError"><span>这道题必填哦</span></div>\n      <div class="js-questionnaireOption">').concat(e,"</div>").trim(),t},tips:function(e){var t=document.createElement("div");return t.setAttribute("class","live-questionnaire-tips"),t.textContent=e,t}},F=function(e){function i(e){var t,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return o()(this,i),(t=f()(this,b()(i).call(this))).visible=!1,t.el=document.getElementById(e),t.id,t.isClient=n,t.config={},t.idLists=[],"function"!=typeof t.config.startCallback&&(t.config.startCallback=function(){}),"function"!=typeof t.config.endCallback&&(t.config.endCallback=function(){}),"function"!=typeof t.config.successCallback&&(t.config.successCallback=function(){}),t}return y()(i,e),u()(i,[{key:"singleHandler",value:function(e,t,n){n.answer!==t&&(n.currentEl&&n.currentEl.classList.remove("checked"),n.required&&n.showError&&(n.showError=!1,n.tips.classList.add("ppt-hide")),e.classList.add("checked"),n.answer=t,n.currentEl=e)}},{key:"multiHandler",value:function(e,t,n){n.answer||(n.answer={}),n.answer[t]?(e.classList.remove("checked"),delete n.answer[t]):(e.classList.add("checked"),n.answer[t]=!0),n.required&&n.showError&&0<d()(n.answer).length&&(n.showError=!1,n.tips.classList.add("ppt-hide"))}},{key:"keyboardFix",value:function(){var e=this;U&&navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)&&(this.keyboardTimer&&clearTimeout(this.keyboardTimer),this.keyboardTimer=setTimeout(function(){window.scrollTo(0,window.pageYOffset),clearTimeout(e.keyboardTimer)},200))}},{key:"askHandler",value:function(e,t){var n=this;e.querySelector("textarea").addEventListener("change",function(e){t.answer=e.target.value.trim(),t.required&&t.showError&&t.answer&&(t.showError=!1,t.tips.classList.add("ppt-hide"))}),e.querySelector("textarea").addEventListener("blur",function(){n.keyboardFix()})}},{key:"initOptionHandler",value:function(s){var r=this;"Q"===s.type?this.askHandler(s.el,s):s.el.addEventListener("click",function(e){for(var t,n=e.target,i=!0;i;){if((t=n.getAttribute("data-answer"))||n===s.el){i=!1;break}n=n.parentNode}t&&("R"===s.type?r.singleHandler(n,t,s):r.multiHandler(n,t,s))})}},{key:"initBtnHandler",value:function(){var l=this;this.data.el.addEventListener("click",function(e){for(var t,n=e.target,i=!0;i;){if((t=n.getAttribute("data-type"))||n===l.data.el){i=!1;break}n=n.parentNode}if(t){var s=l.data.el.querySelector(".live-questionnaire-container");if("close"===t&&(l.remove(),l.emit("stopQuestionNaire"),l.config.endCallback()),"submit"===t){if(!l.data.allow)return;var r=[],a=!0,o=!1;if(l.data.questions.forEach(function(e){var t=e.answer;"C"===e.type&&(t=t||{},t=d()(t).sort().join("")),"Q"===e.type&&(t=Z.parseString(t)),e.required&&!t?(a=!1,e.tips.classList.remove("ppt-hide"),e.showError=!0,o||(s.scrollTop=e.el.offsetTop-60,o=!0)):r.push({questionId:e.id,answer:t})}),!a)return;var c=l.data.id;if(6<=_)return l.emit("endQuestionnaireAnswer",{id:c,answers:r}),l.el.classList.add("ppt-hide"),void l.remove();l.showTips("提交成功","success",function(){l.emit("endQuestionnaireAnswer",{id:c,answers:r}),l.el.classList.add("ppt-hide")}),l.remove()}}})}},{key:"showTips",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"success",i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},s=Z.tips(e);s.classList.add("live-questionnaire-tips-".concat(n)),this.el.appendChild(s),setTimeout(function(){t.el.removeChild(s),i()},2e3)}},{key:"remove",value:function(){this.el.removeChild(this.data.el),this.data=void 0}},{key:"render",value:function(){var t=this,e=Z.layout(this.data,this.isClient),n=e.querySelector(".js-questionnaireContent");this.data.questions.forEach(function(e){e.el=Z.question(e),e.tips=e.el.querySelector(".js-questionnaireError"),n.appendChild(e.el),t.initOptionHandler(e)}),this.data.btn=Z.btn(),n.appendChild(this.data.btn),this.el.appendChild(e),this.data.el=e,this.initBtnHandler()}},{key:"formatQuestions",value:function(e){return e.map(function(n,e){return{required:"Y"===n.required,type:n.type,name:Z.parseString(n.name),id:n.questionId,index:e+1,options:P()(new Array(10)).map(function(e,t){return n["option".concat(t+1)]}).filter(function(e){return!!Z.parseString(e)})}})}},{key:"startQuestionNaire",value:function(e){if(this.el.classList.remove("ppt-hide"),-1===this.idLists.indexOf(e.questionnaireId)){if(this.data){if(this.data.id===e.content.questionnaireId)return;this.remove()}this.config.startCallback(),this.data={title:Z.parseString(e.content.questionnaireTitle),id:e.content.questionnaireId,questions:this.formatQuestions(e.content.questions),allow:!0},this.render()}}},{key:"stopQuestionNaire",value:function(e){var t=this;this.idLists.push(e.questionnaireId),this.data?(this.showTips("问卷已截止","stop",function(){t.emit("stopQuestionNaire")}),this.remove()):this.emit("stopQuestionNaire")}},{key:"returnResutQuestionnaire",value:function(e){var t=this,n=J.mainTmp(e);this.el.classList.remove("ppt-hide"),this.el.appendChild(n),document.getElementById("questionnaireResultClose").addEventListener("click",function(){t.el.removeChild(n),t.emit("stopQuestionNaire")})}}]),i}(S.a),j=n(29),z=n.n(j),G=(n(155),n(38)),Y=n.n(G),X=n(82),$=n.n(X),ee=n(83),te=n.n(ee),ne=function(e){var r=e.url,a=e.data,t=e.method,o=void 0===t?"GET":t,n=e.signPrefix,c=void 0===n?"":n,l=e.baseUrl,i=e.sign,u=void 0===i||i;return new z.a(function(e,t){var n=r;n=l?l+n:"https://api.polyv.net"+n,u&&function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=Y()({},e);n.timestamp=$()();var i,s,r,a=(i=n,s=d()(i).filter(function(e){return"sign"!==e}).sort(),r="",s.forEach(function(e){r+="".concat(e).concat(i[e])}),r);n.sign=te()("".concat(t).concat(a).concat(t)).toUpperCase()}(a,c);var i=o.toLowerCase(),s=new XMLHttpRequest;s.onreadystatechange=function(){4===s.readyState&&(200==s.status?e(JSON.parse(s.responseText)):t(s))},"get"===i?(n+=-1===n.indexOf("?")?"?":"&",n+=function(e){var t=[];for(var n in e)t.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(e[n])));return t.join("&")}(a),s.open("GET",n),s.send()):"post"===i&&(s.open("POST",n),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(a))})},ie={getWinnersList:function(e){var t=e.lotteryId,n=e.page;return ne({url:"/live/front/lottery/".concat(t,"/winners"),data:{page:n},sign:!1})}},se=Y()({},ie),re=L("version"),ae=L("useWKWebviewForIOS"),oe="3"===re,ce={lotteryMain:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"start",t=1<arguments.length?arguments[1]:void 0,n="中奖结果",i="";switch(e){case"start":n="正在抽奖",i=this.lotteryStart();break;case"notWin":i=this.lotteryNotWin(t);break;case"winnerContent":i=this.winnerContent(t);break;case"submit":n="填写联系信息",i=this.listContent(t);break;case"list":n="中奖名单",i=this.winnerList(t)}var s=document.createElement("div");return s.setAttribute("class","lottery-main-content lottery-main-".concat(e," el-lottery-content")),s.innerHTML='\n      <div class="lottery-head head-'.concat(e,'">\n        ').concat(n,'\n        <span class="lottery-head-close" data-type="').concat("submit"===e||"winnerContent"===e?"lottery-close":"close",'"></span>\n        <span class="lottery-head-back" data-type="back"></span>\n      </div>\n      ').concat(i,"\n    "),s},winnerList:function(e){return'\n      <ul class="lottery-winner-list__content">\n        '.concat(this.getList(e),'\n      </ul>\n      <div class="lottery-list__back">\n        <button data-type="back">返回</button>\n      </div>\n    ')},getList:function(e){var n=this;return function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:3;if(0===!e.length)return[];for(var n=e.length,i=n%t==0?n/t:Math.floor(n/t+1),s=[],r=0;r<i;r++){var a=e.slice(r*t,r*t+t);s.push(JSON.parse(h()(a)))}return s}(e=e.winnersList).reduce(function(e,t){return e+"<li>".concat(n.getItem(t),"</li>")},"")},getItem:function(e){return 0===e.length?"":e.reduce(function(e,t){return e+"<span>".concat(t.nick,"</span>")},"")},winnerContent:function(e){var t=4<re&&0<e.winnersList.length||5<re?'<button class="lottery-list" data-type="list">查看中奖名单</button>':"";return'\n      <div class="lottery-winner-content">\n        <i></i>\n        <p class="lottery-prize">恭喜您抽中“'.concat(e.prize,'”</p>\n        <p class="lottery-winner-code">兑换码为:<span>').concat(e.winnerCode,"</span></p>\n        ").concat(t,'\n        <button class="lottery-collection" data-type="col-info">填写联系信息</button>\n      </div>\n    ')},listContent:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=(e=JSON.parse(h()(e))).collectInfo.splice(2).reduce(function(e,t,n){return e+'<input class="lottery-custom-'.concat(n,'" placeholder="').concat(t.tips,'" />')},"");return'\n      <div class="lottery-list-collection">\n        <div class="lottery-input">\n          <p>请填写以下信息，后续会有工作人员与您联系</p>\n          <input class="lottery-name" id="lotteryName" type="text" placeholder="请输入真实姓名">\n          <input class="lottery-tel" id="lotteryTel" type="text" placeholder="请输入手机号码">\n          '.concat("3"===re?'<input class="lottery-adr" id="lotteryAdr" type="text" placeholder="请输入收件地址">':"","\n          ").concat(4<re?t:"",'\n        </div>\n        <div class="lottery-coll-btn">\n          <button id="lotterySubmit" data-type="submit-lottery">提交</button>\n        </div>\n      </div>')},lotteryStart:function(){return'<span class="lottery-start-gif"></span>'},lotteryNotWin:function(e){var t=4<re&&0<e.winnersList.length||5<re?'<button class="lottery-list" data-type="list">查看中奖名单</button>':"";return'\n      <div class="lottery-content__not__win">\n        <i class="icon-sad"></i>\n        <p>很遗憾您未中奖，谢谢参与</p>\n        '.concat(t,'\n        <button class="lottery-btn-close" data-type="close-webview">我知道了</button>\n      </div>')},lotteryPrompt:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("div");return t.setAttribute("class","lottery-prompt ppt-hide"),t.innerHTML=e,t}},le=function(e){function n(e){var t;return o()(this,n),(t=f()(this,b()(n).call(this))).specailCh=!1,t.wrongNum=!1,t.addressLegal=!0,t.customZeroCorrect=!0,t.customOneCorrect=!0,t.customTwoCorrect=!0,t.customZeroValue="",t.customOneValue="",t.customTwoValue="",t.visible=!1,t.nameValue="",t.telephoneNumber="",t.addressValue=null,t.timer=null,t.wrap=document.getElementById(e),t.endData=[],t.receiveInfo=[],t.winnersPage=1,t.winnersTotalPages=1/0,t.channelId="",t.lotteryId="",t.isGetWinnering=!1,t.bindEvent(),t}var t;return y()(n,e),u()(n,[{key:"lotteryAttribute",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(this.closeElement(),this.visible=!0,this.el=ce.lotteryMain(e,t),this.wrap.appendChild(this.el),"submit"===e){var n=ce.lotteryPrompt();this.el.appendChild(n),this.promptEl=document.getElementsByClassName("lottery-prompt")[0],this.inputCheck()}switch(this.wrap.classList.add("lottery-show"),e){case"list":5<re&&this.listenScroll()}}},{key:"listenScroll",value:function(){var e,t,o=this,c=document.querySelector(".lottery-winner-list__content");c.addEventListener("scroll",(e=l()(p.a.mark(function e(){var t,n,i,s,r,a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this,n=Math.max(t.scrollHeight,t.offsetHeight),i=t.innerHeight||t.clientHeight||t.clientHeight||0,s=t.pageYOffset||t.scrollTop||t.scrollTop||0,2e3<=o.endData.winnersList.length||o.winnersPage>=o.winnersTotalPages)return e.abrupt("return");e.next=8;break;case 8:if(n-i-s<40)return o.winnersPage++,o.endData.winnersPage=o.winnersPage,e.next=13,o.getWinners(o.winnersPage);e.next=16;break;case 13:r=e.sent,a=ce.getList({winnersList:r}),c.innerHTML+=a;case 16:case"end":return e.stop()}},e,this)})),100,t=null,function(){null!==t&&clearTimeout(t),t=setTimeout(e.bind(this),100)}))}},{key:"getWinners",value:(t=l()(p.a.mark(function e(t){var n,i,s;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isGetWinnering=!0,e.next=3,se.getWinnersList({lotteryId:this.lotteryId,page:t});case 3:if(n=e.sent,this.isGetWinnering=!1,200===n.code)return this.winnersTotalPages=n.data.totalPages,s=n.data.contents.map(function(e){return{nick:e.viewerName}}),(i=this.endData.winnersList).push.apply(i,q()(s)),e.abrupt("return",s);e.next=10;break;case 10:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"stopLottery",value:function(e){e.winnersList||(e.winnersList=[]),e.collectInfo||(e.collectInfo=[]),"string"==typeof e.collectInfo&&(e.collectInfo=JSON.parse(e.collectInfo)),this.receiveInfo=JSON.parse(h()(e.collectInfo)),this.endData=e,5<re&&(this.channelId=e.channelId,this.lotteryId=e.lotteryId),e.win?this.lotteryAttribute("winnerContent",e):this.lotteryAttribute("notWin",e)}},{key:"closeElement",value:function(){document.getElementsByClassName("el-lottery-content")[0]&&(this.el.remove(),this.el=null,this.wrap.classList.remove("lottery-show"))}},{key:"closeLotteryWinner",value:function(){confirm("确认放弃领取奖品？")&&(this.emit("abandonLottery"),this.closeElement(),this.emit("closeLotteryWebview"))}},{key:"bindEvent",value:function(){var t,d=this;this.wrap.addEventListener("click",(t=l()(p.a.mark(function e(t){var n,i,s,r,a,o,c,l,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.getAttribute("data-type")){e.next=3;break}return e.abrupt("return");case 3:e.t0=n,e.next="close"===e.t0?6:"submit-lottery"===e.t0?9:"lottery-close"===e.t0?24:"list"===e.t0?27:"back"===e.t0?35:"col-info"===e.t0?37:"close-webview"===e.t0?39:42;break;case 6:return d.closeElement(),d.emit("closeLotteryWebview"),e.abrupt("break",43);case 9:if(d.checkAllowSubmit())return d.tipsShow("请填写正确信息"),e.abrupt("break",43);e.next=12;break;case 12:if(i=d.receiveInfo,s=d.nameValue,r=d.telephoneNumber,a=d.customZeroValue,o=d.customOneValue,c=d.customTwoValue,l=[s,r,a,o,c],i.map(function(e,t){e.value=l[t],delete e.tips}),u={name:s,telephone:r,address:"",receiveInfo:i},oe&&(u.address=d.addressValue),d.emit("sendWinData",u),6<=re)return d.closeElement(),d.visible=!1,e.abrupt("return");e.next=22;break;case 22:return d.tipsShow("提交成功").then(function(){d.closeElement(),d.emit("closeLotteryWebview")}),e.abrupt("break",43);case 24:return confirm("确认放弃领取奖品？")&&(d.emit("abandonLottery"),d.closeElement(),d.emit("closeLotteryWebview")),e.abrupt("break",43);case 27:if(d.winnersPage=1,d.endData.winnersList=[],d.isGetWinnering)return e.abrupt("break",43);e.next=31;break;case 31:return e.next=33,d.getWinners(d.winnersPage);case 33:return d.lotteryAttribute("list",d.endData),e.abrupt("break",43);case 35:return d.stopLottery(d.endData),e.abrupt("break",43);case 37:return d.lotteryAttribute("submit",d.endData),e.abrupt("break",43);case 39:return d.closeElement(),d.emit("closeLotteryWebview"),e.abrupt("break",43);case 42:return e.abrupt("break",43);case 43:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}))}},{key:"blur",value:function(){var e=document.getElementById("lotteryName"),t=document.getElementById("lotteryTel");e&&e.blur(),t&&t.blur()}},{key:"tipsShow",value:function(e){var t=this;return this.promptEl.innerHTML=e,this.promptEl.classList.remove("ppt-hide"),new z.a(function(e){clearTimeout(t.timer),t.timer=setTimeout(function(){t.promptEl.classList.add("ppt-hide"),e()},3e3)})}},{key:"checkAllowSubmit",value:function(){return this.specailCh||this.wrongNum||!this.nameValue||!this.telephoneNumber||!this.addressLegal||!this.customZeroCorrect||!this.customOneCorrect||!this.customTwoCorrect}},{key:"checkSpecailChar",value:function(e){return!!e.match(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]"].join("|"))}},{key:"keyboardFix",value:function(){var e=this;ae&&navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)&&(this.keyboardTimer&&clearTimeout(this.keyboardTimer),this.keyboardTimer=setTimeout(function(){window.scrollTo(0,window.pageYOffset),clearTimeout(e.keyboardTimer)},200))}},{key:"inputCheck",value:function(){var n=this,i=document.getElementById("lotteryName"),s=document.getElementById("lotteryTel"),e=document.querySelector(".lottery-custom-0"),t=document.querySelector(".lottery-custom-1"),r=document.querySelector(".lottery-custom-2");this.nameValue="",this.telephoneNumber="",this.addressValue="",e&&(this.customZeroCorrect=!1),t&&(this.customOneCorrect=!1),r&&(this.customTwoCorrect=!1),i.addEventListener("blur",function(e){var t=e.target.value.trim();10<t.length&&(t=t.substr(0,10),i.value=t),n.specailCh=n.checkSpecailChar(t),n.specailCh&&n.tipsShow("不可输入特殊字符"),n.nameValue=t,n.keyboardFix()}),s.addEventListener("keyup",function(e){var t=e.target.value;s.value=t.replace(/[^0-9.]/g,""),11<t.length&&(t=t.substr(0,11),s.value=t)}),s.addEventListener("blur",function(e){var t=e.target.value.trim();/^1\d{10}$/.test(t)&&/^1[3456789]\d{9}$/.test(t)?n.wrongNum=!1:(n.tipsShow("请输入正确号码"),n.wrongNum=!0),n.telephoneNumber=t,n.keyboardFix()}),oe&&document.getElementById("lotteryAdr").addEventListener("blur",function(e){var t=e.target.value.trim();n.addressLegal=!n.checkSpecailChar(t),console.log(n.addressLegal,t),n.addressLegal||n.tipsShow("不可输入特殊字符"),n.addressValue=t,n.keyboardFix()}),e&&e.addEventListener("blur",function(e){var t=e.target.value.trim();n.customZeroLagal=n.checkSpecailChar(t),n.customZeroLagal&&n.tipsShow("不可输入特殊字符"),n.customZeroValue=t,n.customZeroValue&&!n.customZeroLagal&&(n.customZeroCorrect=!0),n.keyboardFix()}),t&&t.addEventListener("blur",function(e){var t=e.target.value.trim();n.customOneLagal=n.checkSpecailChar(t),n.customOneLagal&&n.tipsShow("不可输入特殊字符"),n.customOneValue=t,n.customOneValue&&!n.customOneLagal&&(n.customOneCorrect=!0),n.keyboardFix()}),r&&r.addEventListener("blur",function(e){var t=e.target.value.trim();n.customTwoLagal=n.checkSpecailChar(t),n.customTwoLagal&&n.tipsShow("不可输入特殊字符"),n.customTwoValue=t,n.customTwoValue&&!n.customTwoLagal&&(n.customTwoCorrect=!0),n.keyboardFix()})}}]),n}(S.a),ue=(n(166),L("version")),de=function(e){function n(e){var t;return o()(this,n),(t=f()(this,b()(n).call(this))).signTimer=null,t.wrap=document.getElementById(e),t.visible=!1,t.bindEvent(),t}return y()(n,e),u()(n,[{key:"startSign",value:function(e){var t,n;this.wrapClose(),this.visible=!0,this.el=(t=e,(n=document.createElement("div")).className="player-signed-container",n.innerHTML='\n      <span data-type="close">×</span>\n      <div class="signed-time" id="signTime">'.concat(t.limitTime,'</div>\n      <p class="sign-message">').concat(t.message,'</p>\n      <button class="btn-signed" data-type="sign-in" id="btnSign">签到</buttton>\n    '),n),this.wrap.appendChild(this.el),this.wrap.classList.add("sign-show"),this.signTime=document.getElementById("signTime"),this.btnSign=document.getElementById("btnSign"),this.startCountDown(Number(e.limitTime))}},{key:"stopSign",value:function(){var e=this;clearInterval(this.signTimer),this.btnSign&&(this.visible=!0,this.btnSign.setAttribute("class","btn-sign-stop"),this.btnSign.setAttribute("disabled","disabled"),this.btnSign.innerHTML="签到已截止",setTimeout(function(){e.wrapClose(),e.emit("closeSignWebview")},3e3))}},{key:"startCountDown",value:function(n){var i=this;clearInterval(this.signTimer);var s=(new Date).getTime();this.signTimer=setInterval(function(){var e=(new Date).getTime()-s,t=n-V()(e/1e3,10);(i.signTime.innerHTML=t)<1&&i.stopSign()},500)}},{key:"wrapClose",value:function(){document.getElementsByClassName("player-signed-container")[0]&&(this.el.remove(),this.el=null,this.wrap.classList.remove("sign-show"))}},{key:"bindEvent",value:function(){var i=this;this.wrap.addEventListener("click",function(e){var t=e.target.getAttribute("data-type");if(t)if("sign-in"===t){if(clearInterval(i.signTimer),i.timmer=null,6<=ue)return i.emit("submitSign"),i.wrapClose(),i.visible=!1,void i.emit("closeSignWebview");var n=i.btnSign;signTime.innerHTML='<span class="submit-sign"></span>',n.setAttribute("class","btn-sign-submit"),n.setAttribute("disabled","disabled"),n.innerHTML="签到成功",i.emit("submitSign"),setTimeout(function(){i.wrapClose(),i.emit("closeSignWebview")},3e3)}else"close"===t&&(clearInterval(i.signTimer),i.wrapClose(),i.emit("closeSignWebview"))})}}]),n}(S.a);n(167);var pe,ve,he,we=("version",pe=window.location.search,ve=new RegExp("(^|&)".concat("version","=([^&]*)(&|$)")),(he=pe.substr(1).match(ve))?decodeURIComponent(he[2].replace(/\s*/g,"")):null),fe=function(e){function i(e,t){var n;return o()(this,i),(n=f()(this,b()(i).call(this))).visible=!1,n.empty=!0,n.isPc=t||!1,n.el=document.getElementById(e),n.els=q()(n.el.querySelectorAll("[data-el]")).reduce(function(e,t){return e[t.getAttribute("data-el")]=t,e},{}),n.bindCloseEvent(),n}return y()(i,e),u()(i,[{key:"bindCloseEvent",value:function(){var e=this,t=function(){e.hide(),e.emit("close"),e.remove()};!this.isPc&&this.els.close.addEventListener("click",t),this.els.know.addEventListener("click",t)}},{key:"show",value:function(){this.visible=!0,this.el.classList.remove("ppt-hide")}},{key:"hide",value:function(){this.visible=!1,this.el.classList.add("ppt-hide")}},{key:"append",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.els.content.innerHTML=e||"暂无公告",this.empty=!e,t&&(this.show(),this.bindLinkEvent())}},{key:"remove",value:function(){this.append("",!1)}},{key:"bindLinkEvent",value:function(){var e=q()(this.el.querySelectorAll("a")),t=this;e.forEach(function(e){e.addEventListener("click",function(e){t.emit("linkClick",e.target.href),"4"<=we&&e.preventDefault()})})}},{key:"emptyAndVisible",get:function(){return this.empty&&this.visible}}]),i}(S.a),me=(n(168),function(e){function i(e,t){var n;return o()(this,i),(n=f()(this,b()(i).call(this))).visible=!1,n.isPc=t||!1,n.el=document.getElementById(e),n.els=q()(n.el.querySelectorAll("[data-el]")).reduce(function(e,t){return e[t.getAttribute("data-el")]=t,e},{}),n.bindCloseEvent(),n}return y()(i,e),u()(i,[{key:"bindCloseEvent",value:function(){var e=this,t=function(){e.hide()};!this.isPc&&this.els.close.addEventListener("click",t),this.els.know.addEventListener("click",t)}},{key:"show",value:function(){this.visible=!0,this.el.classList.remove("ppt-hide")}},{key:"hide",value:function(){this.visible=!1,this.el.classList.add("ppt-hide"),this.append("",!1),this.emit("close")}},{key:"append",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.els.content.innerHTML=e||"",t&&this.show()}}]),i}(S.a)),be=(n(169),function(e){function n(){var e,t;return o()(this,n),(e=f()(this,b()(n).call(this))).visible=!1,e.el=document.body.appendChild(((t=document.createElement("div")).setAttribute("id","interactTips"),t)),e}return y()(n,e),u()(n,[{key:"showTips",value:function(e){var t,n,i,s=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"success",a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},o=(t=e,n=r,(i=document.createElement("div")).innerHTML='\n    <div class="live-interact-tips-warp">\n      <div class="live-interact-tips live-interact-tips-'.concat(n,'">').concat(t,"</div>\n    </div>\n  "),i);this.visible=!0,this.el.appendChild(o),setTimeout(function(){s.el.removeChild(o),s.visible=!1,s.emit("closeWebview"),a()},2e3)}}]),n}(S.a));function ge(e){var t=window.location.search,n=new RegExp("(^|&)".concat(e,"=([^&]*)(&|$)")),i=t.substr(1).match(n);return i?decodeURIComponent(i[2].replace(/\s*/g,"")):null}var ye=ge("version"),ke=ge("useWKWebviewForIOS");new(function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};o()(this,n),this.answer=new N(e.answerCard),this.questionnaire=new F(e.questionnaire),this.lottery=new le(e.lottery),this.sign=new de(e.sign),this.announcement=new fe(e.announcement),this.pauseTip=new me(e.pauseTip),this.tips=new be,this.hideClass="ppt-hide",this.zIndex=10,this.eventLists=null,this.bindBridgeEvents(),this.bindAnswerEvent(),this.bindQuestionnaireEvent(),this.bindLotteryEvent(),this.bindSignEvent(),this.bindAnnouncementEvent(),this.bindPauseTipEvent(),this.bindTipsEvent();var t=setTimeout(function(){C.initWebview()},200);C.on("bridgeInit",function(){clearTimeout(t),setTimeout(function(){C.initWebview()},200)})}return u()(n,[{key:"bridgeEvents",value:function(){var t,a=this;return{updateNewQuestion:function(e){a.announcementHandle(),a.answer.visible=!0,n.setZIndex(a.answer.wrap,++a.zIndex),a.answer.updateNewQuestion(JSON.parse(e)),a.lottery.blur(),a.initWKPosition()},hasChooseAnswer:function(e){a.announcementHandle();var t=JSON.parse(e);a.answer.visible=!0,n.setZIndex(a.answer.wrap,++a.zIndex),a.answer.hasChooseAnswer(t.answerId,t.data),a.lottery.blur(),a.initWKPosition()},extraQuestionMessageHandler:function(e){a.announcementHandle();var t=JSON.parse(e);"STOP_TEST_QUESTION"===t.EVENT&&(a.answer.visible=!0,n.setZIndex(a.answer.wrap,++a.zIndex),a.answer.stopQuestion(t),a.lottery.blur(),a.initWKPosition())},startQuestionNaire:function(e){a.announcementHandle(),a.questionnaire.visible=!0,n.setZIndex(a.questionnaire.el,++a.zIndex),a.questionnaire.startQuestionNaire(JSON.parse(e)),a.lottery.blur(),a.initWKPosition()},stopQuestionNaire:function(e){a.announcementHandle(),a.questionnaire.visible=!0,a.questionnaire.stopQuestionNaire(JSON.parse(e)),a.initWKPosition()},startLottery:function(){a.announcementHandle(),a.lottery.visible=!0,a.lottery.lotteryAttribute("start"),n.setZIndex(a.lottery.wrap,++a.zIndex),a.initWKPosition()},stopLottery:(t=l()(p.a.mark(function e(t){var n,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=JSON.parse(t),n=t,5<ye&&((i={win:!(!t.data||!t.data.length),prize:t.prize,collectInfo:t.collectInfo,winnersPage:1,channelId:t.channelId,lotteryId:t.lotteryId,winnersList:[]}).win&&(i.winnerCode=t.data[0].winnerCode),n=i),a.announcementHandle(),a.lottery.visible=!0,a.lottery.stopLottery(n),a.initWKPosition();case 7:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),closeLotteryWinner:function(){a.announcementHandle(),a.lottery.closeLotteryWinner()},startSign:function(e){a.announcementHandle(),a.sign.visible=!0,a.sign.startSign(JSON.parse(e)),n.setZIndex(a.sign.wrap,++a.zIndex),a.lottery.blur(),a.initWKPosition()},stopSign:function(){a.sign.stopSign()},bulletin:function(e){a.announcement.append(JSON.parse(e).content),a.initWKPosition()},removeBulletin:function(){a.announcement.remove()},onStartRecord:function(){a.pauseTip.hide()},onPauseRecord:function(e){a.announcementHandle(),a.pauseTip.append(JSON.parse(e).tip)},onExitRecord:function(){a.pauseTip.hide()},interactiveEventCallback:function(e){"string"==typeof e&&(e=JSON.parse(e));var t=e,n=t.EVENT,i=t.code,s="";switch(n){case"TO_SIGN_IN":s={301:"请登录后再签到",302:"签到已结束",303:"已签到",400:"签到失败",200:"签到成功"}[i]||"签到失败";break;case"ANSWER_QUESTIONNAIRE":s={301:"问卷已结束",302:"已提交",400:"提交失败",200:"提交成功"}[i]||"提交失败";break;case"ANSWER_TEST_QUESTION":s={301:"忽略",302:"答题已结束",303:"已答题",400:"提交失败",200:"答题成功"}[i]||"提交失败";break;default:s=200===i?"提交成功":"提交失败"}var r=200===i?"success":"failed";a.tips.showTips(s,r)}}}},{key:"bindBridgeEvents",value:function(){var t=this;this.eventLists=this.bridgeEvents(),d()(this.eventLists).forEach(function(e){C.on(e,t.eventLists[e])})}},{key:"initWKPosition",value:function(){var e=this;ke&&navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)&&(this.keyboardTimer&&clearTimeout(this.keyboardTimer),this.keyboardTimer=setTimeout(function(){window.scrollTo(0,window.pageYOffset),clearTimeout(e.keyboardTimer)},200))}},{key:"announcementHandle",value:function(){this.announcement.emptyAndVisible&&this.announcement.hide()}}],[{key:"setZIndex",value:function(e,t){e.style.zIndex=t}}]),u()(n,[{key:"closeWebview",value:function(){this.answer.visible||this.questionnaire.visible||this.sign.visible||this.lottery.visible||this.announcement.visible||this.pauseTip.visible||this.tips.visible||C.closeWebview()}},{key:"bindTipsEvent",value:function(){var e=this;this.tips.on("closeWebview",function(){e.tips.visible=!1,e.closeWebview()})}},{key:"bindAnswerEvent",value:function(){var t=this;this.answer.on("knowAnswer",function(){t.answer.visible=!1,t.closeWebview()}),this.answer.on("chooseAnswer",function(e){C.chooseAnswer(e),t.answer.visible=!1,t.closeWebview()})}},{key:"bindQuestionnaireEvent",value:function(){var t=this;this.questionnaire.on("endQuestionnaireAnswer",function(e){C.endQuestionnaireAnswer(e),t.questionnaire.visible=!1,t.closeWebview()}),this.questionnaire.on("stopQuestionNaire",function(){t.questionnaire.el.classList.add(t.hideClass),t.questionnaire.visible=!1,t.closeWebview()})}},{key:"bindLotteryEvent",value:function(){var t=this;this.lottery.on("sendWinData",function(e){t.lottery.visible=!1,C.sendWinData(e)}),this.lottery.on("abandonLottery",function(e){t.lottery.visible=!1,C.abandonLottery()}),this.lottery.on("closeLotteryWebview",function(){t.lottery.visible=!1,t.closeWebview()}),/iPad|iPhone|iPod/i.test(navigator.userAgent)&&window.addEventListener("orientationchange",function(){t.lottery.blur()},!1)}},{key:"bindSignEvent",value:function(){var e=this;this.sign.on("submitSign",function(){e.sign.visible=!1,C.submitSign()}),this.sign.on("closeSignWebview",function(){e.sign.visible=!1,e.closeWebview()})}},{key:"bindAnnouncementEvent",value:function(){this.announcement.on("close",this.closeWebview.bind(this)),this.announcement.on("linkClick",function(e){return C.linkClick(e)})}},{key:"bindPauseTipEvent",value:function(){this.pauseTip.on("close",this.closeWebview.bind(this))}}]),n}())({answerCard:"answerCard",questionnaire:"questionnaire",lottery:"lottery",sign:"sign",announcement:"announcement",pauseTip:"pauseTip"})}});